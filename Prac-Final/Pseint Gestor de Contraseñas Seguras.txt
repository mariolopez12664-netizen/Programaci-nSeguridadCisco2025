Algoritmo GestorContrasenasSeguras
    // Declaración de vectores para almacenar usuarios y contraseñas
    Dimension usuarios[50]
    Dimension contrasenas[50]
    Definir usuarios, contrasenas Como Caracter
    Definir totalUsuarios Como Entero
    totalUsuarios <- 0
    
    Definir opcion Como Entero
    Definir continuar Como Logico
    continuar <- Verdadero
    
    // Variables auxiliares
    Definir usuario, contrasena Como Caracter
    
    // Menú principal
    Mientras continuar Hacer
        Limpiar Pantalla
        Escribir "=================================================="
        Escribir "       GESTOR DE CONTRASENAS SEGURAS"
        Escribir "=================================================="
        Escribir "1. Registrar nuevo usuario"
        Escribir "2. Verificar contrasena"
        Escribir "3. Generar reporte de seguridad"
        Escribir "4. Ver recomendaciones de seguridad"
        Escribir "5. Listar usuarios registrados"
        Escribir "6. Salir"
        Escribir "--------------------------------------------------"
        Escribir "Seleccione una opcion (1-6): " Sin Saltar
        Leer opcion
        
        Segun opcion Hacer
            1:
                Escribir ""
                Escribir "--- REGISTRO DE USUARIO ---"
                Escribir "Ingrese nombre de usuario: " Sin Saltar
                Leer usuario
                Escribir "Ingrese contrasena: " Sin Saltar
                Leer contrasena
                RegistrarUsuario(usuarios, contrasenas, totalUsuarios, usuario, contrasena)
                Esperar Tecla
                
            2:
                Escribir ""
                Escribir "--- VERIFICACION DE CONTRASENA ---"
                Escribir "Ingrese nombre de usuario: " Sin Saltar
                Leer usuario
                Escribir "Ingrese contrasena: " Sin Saltar
                Leer contrasena
                VerificarContrasena(usuarios, contrasenas, totalUsuarios, usuario, contrasena)
                Esperar Tecla
                
            3:
                Escribir ""
                Si totalUsuarios > 0 Entonces
                    GenerarAlertas(usuarios, contrasenas, totalUsuarios)
                Sino
                    Escribir "No hay usuarios registrados en el sistema."
                FinSi
                Esperar Tecla
                
            4:
                Escribir ""
                MostrarRecomendaciones
                Esperar Tecla
                
            5:
                Escribir ""
                Escribir "--- USUARIOS REGISTRADOS ---"
                Si totalUsuarios > 0 Entonces
                    Para i <- 1 Hasta totalUsuarios Hacer
                        Escribir i, ". ", usuarios[i]
                    FinPara
                Sino
                    Escribir "No hay usuarios registrados."
                FinSi
                Esperar Tecla
                
            6:
                Escribir ""
                Escribir "Gracias por usar el Gestor de Contrasenas. Hasta pronto!"
                continuar <- Falso
                
            De Otro Modo:
                Escribir ""
                Escribir "Opcion invalida. Intente de nuevo."
                Esperar Tecla
        FinSegun
    FinMientras
FinAlgoritmo

// Función para verificar la fortaleza de una contraseña
Funcion nivel <- VerificarFortaleza(contrasena)
    Definir nivel Como Caracter
    Definir tieneMayuscula, tieneMinuscula, tieneNumero, tieneEspecial, longitudSuficiente Como Logico
    Definir criteriosCumplidos Como Entero
    Definir i Como Entero
    Definir caracter Como Caracter
    
    // Inicializar criterios
    tieneMayuscula <- Falso
    tieneMinuscula <- Falso
    tieneNumero <- Falso
    tieneEspecial <- Falso
    longitudSuficiente <- Falso
    criteriosCumplidos <- 0
    
    // Verificar longitud
    Si Longitud(contrasena) >= 8 Entonces
        longitudSuficiente <- Verdadero
        criteriosCumplidos <- criteriosCumplidos + 1
    FinSi
    
    // Recorrer cada carácter de la contraseña (en PSeInt subcadena comienza en 1)
    Para i <- 1 Hasta Longitud(contrasena) Hacer
        caracter <- Subcadena(contrasena, i, i)
        
        // Verificar mayúsculas (A-Z)
        Si caracter >= "A" Y caracter <= "Z" Entonces
            tieneMayuscula <- Verdadero
        FinSi
        
        // Verificar minúsculas (a-z)
        Si caracter >= "a" Y caracter <= "z" Entonces
            tieneMinuscula <- Verdadero
        FinSi
        
        // Verificar números (0-9)
        Si caracter >= "0" Y caracter <= "9" Entonces
            tieneNumero <- Verdadero
        FinSi
        
        // Verificar caracteres especiales
        Si caracter = "!" O caracter = "@" O caracter = "#" O caracter = "$" O caracter = "%" O caracter = "^" O caracter = "&" O caracter = "*" O caracter = "(" O caracter = ")" Entonces
            tieneEspecial <- Verdadero
        FinSi
    FinPara
    
    // Contar criterios cumplidos
    Si tieneMayuscula Entonces
        criteriosCumplidos <- criteriosCumplidos + 1
    FinSi
    Si tieneMinuscula Entonces
        criteriosCumplidos <- criteriosCumplidos + 1
    FinSi
    Si tieneNumero Entonces
        criteriosCumplidos <- criteriosCumplidos + 1
    FinSi
    Si tieneEspecial Entonces
        criteriosCumplidos <- criteriosCumplidos + 1
    FinSi
    
    // Determinar nivel de fortaleza
    Si criteriosCumplidos = 5 Entonces
        nivel <- "MUY FUERTE"
    Sino
        Si criteriosCumplidos >= 3 Y longitudSuficiente Entonces
            nivel <- "FUERTE"
        Sino
            Si criteriosCumplidos >= 2 Entonces
                nivel <- "MEDIA"
            Sino
                nivel <- "DEBIL"
            FinSi
        FinSi
    FinSi
FinFuncion

// Función para verificar si la contraseña es fuerte
Funcion esFuerte <- EsContrasenaFuerte(nivel)
    Definir esFuerte Como Logico
    Si nivel = "MUY FUERTE" O nivel = "FUERTE" Entonces
        esFuerte <- Verdadero
    Sino
        esFuerte <- Falso
    FinSi
FinFuncion

// SubProceso para registrar un nuevo usuario
SubProceso RegistrarUsuario(usuarios Por Referencia, contrasenas Por Referencia, totalUsuarios Por Referencia, usuario, contrasena)
    Definir encontrado Como Logico
    Definir i Como Entero
    Definir nivel Como Caracter
    Definir esFuerte Como Logico
    
    encontrado <- Falso
    
    // Verificar si el usuario ya existe
    Si totalUsuarios > 0 Entonces
        Para i <- 1 Hasta totalUsuarios Hacer
            Si usuarios[i] = usuario Entonces
                encontrado <- Verdadero
            FinSi
        FinPara
    FinSi
    
    Si encontrado Entonces
        Escribir "Error: El usuario ", usuario, " ya existe."
    Sino
        Si Longitud(usuario) = 0 O Longitud(contrasena) = 0 Entonces
            Escribir "Error: Usuario y contrasena no pueden estar vacios."
        Sino
            // Verificar fortaleza de la contraseña
            nivel <- VerificarFortaleza(contrasena)
            esFuerte <- EsContrasenaFuerte(nivel)
            
            // Agregar usuario y contraseña (incrementar primero para usar índice 1)
            totalUsuarios <- totalUsuarios + 1
            usuarios[totalUsuarios] <- usuario
            contrasenas[totalUsuarios] <- contrasena
            
            Escribir "Usuario ", usuario, " registrado exitosamente."
            Escribir "Fortaleza de contrasena: ", nivel
            
            Si No esFuerte Entonces
                Escribir "ADVERTENCIA: Contrasena debil detectada!"
            FinSi
        FinSi
    FinSi
FinSubProceso

// SubProceso para verificar la contraseña de un usuario
SubProceso VerificarContrasena(usuarios, contrasenas, totalUsuarios, usuario, contrasenaIngresada)
    Definir encontrado Como Logico
    Definir i, indice Como Entero
    
    encontrado <- Falso
    indice <- -1
    
    // Buscar el usuario
    Si totalUsuarios > 0 Entonces
        Para i <- 1 Hasta totalUsuarios Hacer
            Si usuarios[i] = usuario Entonces
                encontrado <- Verdadero
                indice <- i
            FinSi
        FinPara
    FinSi
    
    Si No encontrado Entonces
        Escribir "Usuario ", usuario, " no encontrado."
    Sino
        // Verificar contraseña
        Si contrasenas[indice] = contrasenaIngresada Entonces
            Escribir "Acceso concedido para ", usuario
        Sino
            Escribir "Contrasena incorrecta para ", usuario
        FinSi
    FinSi
FinSubProceso

// SubProceso para generar alertas de seguridad
SubProceso GenerarAlertas(usuarios, contrasenas, totalUsuarios)
    Definir i, contadorDebiles Como Entero
    Definir nivel Como Caracter
    Definir esFuerte Como Logico
    Dimension usuariosDebiles[50]
    Definir usuariosDebiles Como Caracter
    
    contadorDebiles <- 0
    
    Escribir ""
    Escribir "=================================================="
    Escribir "    REPORTE DE SEGURIDAD DE CONTRASENAS"
    Escribir "=================================================="
    
    // Recorrer todos los usuarios
    Para i <- 1 Hasta totalUsuarios Hacer
        nivel <- VerificarFortaleza(contrasenas[i])
        esFuerte <- EsContrasenaFuerte(nivel)
        
        Escribir ""
        Escribir "Usuario: ", usuarios[i]
        Escribir "Fortaleza: ", nivel
        
        Si No esFuerte Entonces
            Escribir "ALERTA: Contrasena insegura!"
            contadorDebiles <- contadorDebiles + 1
            usuariosDebiles[contadorDebiles] <- usuarios[i]
        FinSi
    FinPara
    
    // Resumen de alertas
    Escribir ""
    Escribir "--------------------------------------------------"
    Si contadorDebiles > 0 Entonces
        Escribir "TOTAL DE ALERTAS: ", contadorDebiles
        Escribir "Usuarios con contrasenas debiles: " Sin Saltar
        Para i <- 1 Hasta contadorDebiles Hacer
            Si i < contadorDebiles Entonces
                Escribir usuariosDebiles[i], ", " Sin Saltar
            Sino
                Escribir usuariosDebiles[i]
            FinSi
        FinPara
    Sino
        Escribir "Todas las contrasenas son seguras"
    FinSi
    Escribir "=================================================="
    Escribir ""
FinSubProceso

// SubProceso para mostrar recomendaciones
SubProceso MostrarRecomendaciones
    Escribir ""
    Escribir "RECOMENDACIONES PARA CONTRASENAS SEGURAS:"
    Escribir "- Minimo 8 caracteres"
    Escribir "- Al menos una letra mayuscula"
    Escribir "- Al menos una letra minuscula"
    Escribir "- Al menos un numero"
    Escribir "- Al menos un caracter especial (!@#$%^&*)"
    Escribir ""
FinSubProceso